// wuw â€“ https://github.com/fasttime/wuw
"use strict";{const e=CSSStyleDeclaration.prototype.item,t=Error,n=t.captureStackTrace,r=JSON.stringify,o=Math.floor,i=Math.max,c=Node.prototype.hasChildNodes,f=Object.create,s=Object.defineProperties,a=Object.defineProperty,u=Object.freeze,l=Object.getOwnPropertyDescriptors,d=Object.getOwnPropertyNames,p=Object.getOwnPropertySymbols,g=Proxy,m=g.revocable,h=RangeError,y=Reflect.defineProperty,w=Reflect.deleteProperty,b=Reflect.get,k=Reflect.getPrototypeOf,R=Reflect.setPrototypeOf,P=Reflect.set,v=Set,F=String,A=Symbol,L=TypeError,T=console.error,C=console.log,O=console.warn,M="object"==typeof module?require("perf_hooks").performance:performance;let N,U=new Map;function defineConstant(e,t,n){a(e,t,{configurable:!0,value:n})}function defineFunction(e,t,n){const r=s((...e)=>{try{return N=o,n(...e)}finally{N=void 0}},{length:{configurable:!0,value:n.length},name:{configurable:!0,value:t}}),o=defineInterface(e,t,r).join(".");return r}function defineInterface(e,t,n){const r=(U.get(e)||[]).concat(t);return U.set(n,r),defineConstant(e,t,n),r}function defineVariable(e,t,n,r){a(e,t,{configurable:!0,get:n,set:r})}const j=[],$=[];function runActions(e){e.forEach(e=>e())}const{installCallback:x,notify:S,uninstallAllCallbacks:I,uninstallCallback:K}=(()=>{function e(){t.clear()}const t=new v;return j.push(e),{installCallback:function(e){t.add(e)},notify:function(e){for(const n of t)try{n(e)}catch(e){T(e)}},uninstallAllCallbacks:e,uninstallCallback:function(e){t.delete(e)}}})();let E;const G={},V=(()=>{function r({wuwTarget:e}){const t=_.get(e);if(t){if(t.wuwGeneration===D)return!0;i(e,t)}return!1}function o(e,t){const n=k(e);return R(e,k(t)),n}function i(e,{mirror:t,revoke:n}){n(),function(e,t){const n=a(t);for(const r of n)y(e,r,t[r])}(e,l(t)),R(e,k(t)),_.delete(e)}function a(e){return[...d(e),...p(e)]}function h(e){try{c.call(e)}catch(e){return!1}return!0}function F(){D=A()}function T(){return M.now()}function C(e,t){const n=l(e),r=a(n).filter(r=>!(n[r].configurable&&w(e,r)||(delete n[r],t.has(r)||(t.add(r),0))));return r.length&&E&&E(e,r),n}function O(e){if(void 0===e)throw L(`Argument of ${N} is missing or undefined`);if(!h(e))throw L(`Argument of ${N} does not implement interface Node`);const t=_.get(e);return t&&i(e,t),x}function U(){return F(),x}function j(e){if(void 0===e)throw L(`Argument of ${N} is missing or undefined`);if(!h(e))throw L(`Argument of ${N} does not implement interface Node`);const t=_.get(e);if(!t||t.wuwGeneration!==D){t&&i(e,t);const n=new v,r=C(e,n),o=f(k(e),r),{proxy:c,revoke:s}=m(o,K);R(e,c),_.set(e,{mirror:o,remarkedPropertyKeys:n,revoke:s,wuwGeneration:D})}return x}const x=defineFunction("undefined"==typeof self?global:self,"wuw",j),I={get:function(e,t,n){const o=V.get(e);return o&&o.spy===n&&(r(o),n=e),b(e,t,n)},set:function e(t,n,o,i){const c=V.get(t);return c&&c.spy===i?(r(c)?function(t,n,r){const o={target:t,propertyKey:n,stackTrace:W(e),startTime:T()};let i,c;try{i=P(t,n,r),o.success=i}catch(e){c=e,o.error=c}if(o.endTime=T(),u(o),S(o),void 0!==c)throw c;return i}:P)(t,n,o):P(t,n,o,i)}},K={get:function(t,n,r){const c=_.get(r);if(c&&t===c.mirror){if(c.wuwGeneration===D)return function(t,n,r){const i=o(r,t);let c;try{c=b(t,n,r)}finally{R(r,i)}return function(t,n,r){if("style"===n&&function(t){try{e.call(t,-1)}catch(e){return!1}return!0}(r)){let e=V.get(r);if(e)r=e.spy;else{const n=new g(r,I);e={spy:n,wuwTarget:t},V.set(r,e),r=n}}return r}(r,n,c)}(t,n,r);i(r,c)}return b(t,n,r)},set:function e(t,n,r,c){const f=_.get(c);if(f&&t===f.mirror){if(f.wuwGeneration===D)return function({remarkedPropertyKeys:t},n,r,i,c){const f={target:c,propertyKey:r,stackTrace:W(e),startTime:T()},a=o(c,n);let l,d;try{l=P(n,r,i,c),f.success=l}catch(e){d=e,f.error=d}const p=C(c,t);if(s(n,p),R(c,a),f.endTime=T(),u(f),S(f),void 0!==d)throw d;return l}(f,t,n,r,c);i(c,f)}return P(t,n,r,c)}},V=new WeakMap,_=new WeakMap;let D;const W=(()=>{const e=n?e=>{const t={};return n(t,e),t.stack.replace(/^.{5}\n/,"")}:()=>t().stack.replace(/^(Error\n)?(?:.*\n){4}/,"");return"stackTraceLimit"in t?n=>{const{stackTraceLimit:r}=t;t.stackTraceLimit=1/0;const o=e(n);return t.stackTraceLimit=r,o}:t=>e(t)})();return $.push(F),defineInterface(x,"watching",G),defineFunction(x,"watch",j),defineFunction(x,"unwatch",O),defineFunction(x,"unwatchAll",U),defineFunction(G,"watch",j),defineFunction(G,"unwatch",O),defineFunction(G,"unwatchAll",U),x})();{const e=(e,t)=>{const n=formatList(t.map(formatPropertyKey));O("The target object %o has undeletable properties: %s",e,n)};function formatList(e){let t="",n=0;for(let r=e.length;--r>=0;){switch(n++){case 0:break;case 1:t=` and ${t}`;break;default:t=`, ${t}`}t=e[r]+t}return t}function formatPropertyKey(e){return("string"==typeof e?r:F)(e)}function getRemarkUndeletableProperties(){return E}function setRemarkUndeletableProperties(e){if(void 0!==e&&null!==e&&"function"!=typeof e)throw L("remarkUndeletableProperties must be a function, undefined or null");E=e||null}E=e,defineConstant(V,"defaultRemarkUndeletableProperties",e),defineVariable(V,"remarkUndeletableProperties",getRemarkUndeletableProperties,setRemarkUndeletableProperties),defineConstant(G,"defaultRemarkUndeletableProperties",e),defineVariable(G,"remarkUndeletableProperties",getRemarkUndeletableProperties,setRemarkUndeletableProperties)}const _={};{function do_(e){if(void 0===e)throw L(`Argument of ${N} is missing or undefined`);if("function"!=typeof e)throw L(`Argument of ${N} is not a function`);return x(e),V}function doNothing(){return I(),V}function dont(e){if(void 0===e)throw L(`Argument of ${N} is missing or undefined`);if("function"!=typeof e)throw L(`Argument of ${N} is not a function`);return K(e),V}defineInterface(V,"doing",_),defineFunction(V,"do",do_),defineFunction(V,"dont",dont),defineFunction(V,"doNothing",doNothing),defineFunction(_,"do",do_),defineFunction(_,"dont",dont),defineFunction(_,"doNothing",doNothing)}{let e=0;const t=1e4,n=[],r=()=>{e=0,n.splice(0,1/0)};function getMaxRecords(){return t}function*log(){for(;e<n.length;)yield n[e++]}function logRecord(r){n.length>=t&&(e&&--e,n.shift()),n.push(r)}function setMaxRecords(r){if((r=+r)<0||r!==o(r))throw h("Invalid number of records");t=r+0;const c=n.length-t;c>0&&(e=i(e-c,0),n.splice(0,c))}const c=()=>n.slice();j.push(r),$.push(()=>x(logRecord)),defineFunction(V,"clear",r),defineConstant(V,"defaultMaxRecords",t),defineFunction(V,"log",log),defineVariable(V,"maxRecords",getMaxRecords,setMaxRecords),defineFunction(V,"snapshot",c)}{let e=null;const t="undefined"!=typeof setImmediate?()=>void setImmediate(printLiveRecords):(()=>{const{port1:e,port2:t}=new MessageChannel;return e.onmessage=printLiveRecords,()=>t.postMessage()})(),n=()=>(K(printLiveRecordLater),V),r=()=>(x(printLiveRecordLater),V);function printLiveRecordLater(n){e?e.push(n):(e=[n],t())}function printLiveRecords(){for(;;){const t=e.shift();if(!t)break;C("wuw record\n%o",t)}e=null}{const e=()=>r();defineFunction(e,"on",r),defineFunction(e,"off",n),defineFunction(V,"live",e)}}{function reset(){return runActions(j),runActions($),V}defineFunction(V,"reset",reset)}U=null,runActions($)}